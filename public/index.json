[{"content":"","date":null,"permalink":"/","section":"✨ Bayoumy blog","summary":"","title":"✨ Bayoumy blog"},{"content":"","date":null,"permalink":"/tags/active-directory/","section":"Tags","summary":"","title":"Active Directory"},{"content":"","date":null,"permalink":"/categories/active-directory-lab/","section":"Categories","summary":"","title":"Active Directory Lab"},{"content":"","date":null,"permalink":"/categories/","section":"Categories","summary":"","title":"Categories"},{"content":"","date":null,"permalink":"/tags/lab/","section":"Tags","summary":"","title":"Lab"},{"content":" This blog about my ideas, what I\u0026rsquo;m learned \u0026amp; tools i used. ","date":null,"permalink":"/posts/","section":"My Blog","summary":"","title":"My Blog"},{"content":" ActiveDirectory Lab I reinstall my PC with ArchLinux With Hyprland, then install KVM,qemu,libvert and mange it with Virt-Manager, I just follow this gret article.\nToday i will create master image of Windows 11 Enterprise (you can use other edditions).\nWe need Windows 11 iso. Download requred drivers ISO virtio.\nScript to create VM \u0026amp; sysprem unattend.xml in my repo https://github.com/Aabayoumy/libvirt-scripts\nResorces # Install KVM on Linux https://sysguides.com/install-kvm-on-linux Install a Windows 11 Virtual Machine on KVM : https://sysguides.com/install-a-windows-11-virtual-machine-on-kvm My Scripts https://github.com/Aabayoumy/libvirt-scripts.git ","date":"23 November 2024","permalink":"/posts/virtmanager-1/","section":"My Blog","summary":"","title":"My lab beased on Virt-manager"},{"content":"","date":null,"permalink":"/tags/","section":"Tags","summary":"","title":"Tags"},{"content":"","date":null,"permalink":"/tags/virt-manager/","section":"Tags","summary":"","title":"Virt-Manager"},{"content":"","date":null,"permalink":"/tags/powershell/","section":"Tags","summary":"","title":"PowerShell"},{"content":" Install PowerShell 7 #From Microsoft Documentation, or using winget:\nwinget install --id Microsoft.PowerShell --source winget If it\u0026rsquo;s new installed system I like to install all my tools at once with winutil\npowershell -Command \u0026#34;iwr -useb https://christitus.com/win | iex\u0026#34; Install my profile #Run powershell 7 As Administrator then:\npwsh -ExecutionPolicy Bypass -NoProfile -c \u0026#34;iwr https://raw.githubusercontent.com/Aabayoumy/PS-Profile/main/Setup.ps1 | iex\u0026#34; Customize Windows Terminal #Open Windows terminal Settings. Set font to one of nerd fonts. Add color Scheme https://github.com/VictorPLopes/OneDark-Pro-Windows-Terminal or https://github.com/catppuccin/windows-terminal, https://windowsterminalthemes.dev/. Save the settings and restart Windows Terminal to apply the changes.\nMy Terminal Settings:\n{ \u0026#34;$help\u0026#34;: \u0026#34;https://aka.ms/terminal-documentation\u0026#34;, \u0026#34;$schema\u0026#34;: \u0026#34;https://aka.ms/terminal-profiles-schema\u0026#34;, \u0026#34;actions\u0026#34;: [ { \u0026#34;command\u0026#34;: { \u0026#34;action\u0026#34;: \u0026#34;copy\u0026#34;, \u0026#34;singleLine\u0026#34;: false }, \u0026#34;id\u0026#34;: \u0026#34;User.copy.644BA8F2\u0026#34;, \u0026#34;keys\u0026#34;: \u0026#34;ctrl+c\u0026#34; }, { \u0026#34;command\u0026#34;: \u0026#34;paste\u0026#34;, \u0026#34;id\u0026#34;: \u0026#34;User.paste\u0026#34;, \u0026#34;keys\u0026#34;: \u0026#34;ctrl+v\u0026#34; }, { \u0026#34;command\u0026#34;: \u0026#34;find\u0026#34;, \u0026#34;id\u0026#34;: \u0026#34;User.find\u0026#34;, \u0026#34;keys\u0026#34;: \u0026#34;ctrl+shift+f\u0026#34; }, { \u0026#34;command\u0026#34;: { \u0026#34;action\u0026#34;: \u0026#34;splitPane\u0026#34;, \u0026#34;split\u0026#34;: \u0026#34;auto\u0026#34;, \u0026#34;splitMode\u0026#34;: \u0026#34;duplicate\u0026#34; }, \u0026#34;id\u0026#34;: \u0026#34;User.splitPane.A6751878\u0026#34;, \u0026#34;keys\u0026#34;: \u0026#34;alt+shift+d\u0026#34; } ], \u0026#34;copyFormatting\u0026#34;: \u0026#34;none\u0026#34;, \u0026#34;copyOnSelect\u0026#34;: false, \u0026#34;defaultProfile\u0026#34;: \u0026#34;{574e775e-4f2a-5b96-ac1e-a2962a402336}\u0026#34;, \u0026#34;newTabMenu\u0026#34;: [ { \u0026#34;type\u0026#34;: \u0026#34;remainingProfiles\u0026#34; } ], \u0026#34;profiles\u0026#34;: { \u0026#34;defaults\u0026#34;: { \u0026#34;colorScheme\u0026#34;: \u0026#34;One Dark Pro\u0026#34;, \u0026#34;cursorShape\u0026#34;: \u0026#34;filledBox\u0026#34;, \u0026#34;font\u0026#34;: { \u0026#34;cellHeight\u0026#34;: \u0026#34;1.4\u0026#34;, \u0026#34;face\u0026#34;: \u0026#34;JetBrainsMono Nerd Font\u0026#34;, \u0026#34;size\u0026#34;: 12 }, \u0026#34;opacity\u0026#34;: 80, \u0026#34;scrollbarState\u0026#34;: \u0026#34;hidden\u0026#34;, \u0026#34;useAcrylic\u0026#34;: true }, \u0026#34;list\u0026#34;: [ { \u0026#34;commandline\u0026#34;: \u0026#34;%SystemRoot%\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\u0026#34;, \u0026#34;guid\u0026#34;: \u0026#34;{61c54bbd-c2c6-5271-96e7-009a87ff44bf}\u0026#34;, \u0026#34;hidden\u0026#34;: false, \u0026#34;name\u0026#34;: \u0026#34;Windows PowerShell\u0026#34; }, { \u0026#34;commandline\u0026#34;: \u0026#34;%SystemRoot%\\\\System32\\\\cmd.exe\u0026#34;, \u0026#34;guid\u0026#34;: \u0026#34;{0caa0dad-35be-5f56-a8ff-afceeeaa6101}\u0026#34;, \u0026#34;hidden\u0026#34;: false, \u0026#34;name\u0026#34;: \u0026#34;Command Prompt\u0026#34; }, { \u0026#34;guid\u0026#34;: \u0026#34;{574e775e-4f2a-5b96-ac1e-a2962a402336}\u0026#34;, \u0026#34;hidden\u0026#34;: false, \u0026#34;name\u0026#34;: \u0026#34;PowerShell\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;Windows.Terminal.PowershellCore\u0026#34; }, { \u0026#34;guid\u0026#34;: \u0026#34;{46ca431a-3a87-5fb3-83cd-11ececc031d2}\u0026#34;, \u0026#34;hidden\u0026#34;: false, \u0026#34;name\u0026#34;: \u0026#34;kali-linux\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;Windows.Terminal.Wsl\u0026#34; }, { \u0026#34;guid\u0026#34;: \u0026#34;{b453ae62-4e3d-5e58-b989-0a998ec441b8}\u0026#34;, \u0026#34;hidden\u0026#34;: false, \u0026#34;name\u0026#34;: \u0026#34;Azure Cloud Shell\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;Windows.Terminal.Azure\u0026#34; }, { \u0026#34;guid\u0026#34;: \u0026#34;{2ece5bfe-50ed-5f3a-ab87-5cd4baafed2b}\u0026#34;, \u0026#34;hidden\u0026#34;: false, \u0026#34;name\u0026#34;: \u0026#34;Git Bash\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;Git\u0026#34; } ] }, \u0026#34;schemes\u0026#34;: [ { \u0026#34;background\u0026#34;: \u0026#34;#282C34\u0026#34;, \u0026#34;black\u0026#34;: \u0026#34;#3F4451\u0026#34;, \u0026#34;blue\u0026#34;: \u0026#34;#4AA5F0\u0026#34;, \u0026#34;brightBlack\u0026#34;: \u0026#34;#4F5666\u0026#34;, \u0026#34;brightBlue\u0026#34;: \u0026#34;#4DC4FF\u0026#34;, \u0026#34;brightCyan\u0026#34;: \u0026#34;#4CD1E0\u0026#34;, \u0026#34;brightGreen\u0026#34;: \u0026#34;#A5E075\u0026#34;, \u0026#34;brightPurple\u0026#34;: \u0026#34;#DE73FF\u0026#34;, \u0026#34;brightRed\u0026#34;: \u0026#34;#FF616E\u0026#34;, \u0026#34;brightWhite\u0026#34;: \u0026#34;#D7DAE0\u0026#34;, \u0026#34;brightYellow\u0026#34;: \u0026#34;#F0A45D\u0026#34;, \u0026#34;cursorColor\u0026#34;: \u0026#34;#ABB2BF\u0026#34;, \u0026#34;cyan\u0026#34;: \u0026#34;#42B3C2\u0026#34;, \u0026#34;foreground\u0026#34;: \u0026#34;#ABB2BF\u0026#34;, \u0026#34;green\u0026#34;: \u0026#34;#8CC265\u0026#34;, \u0026#34;name\u0026#34;: \u0026#34;One Dark Pro\u0026#34;, \u0026#34;purple\u0026#34;: \u0026#34;#C162DE\u0026#34;, \u0026#34;red\u0026#34;: \u0026#34;#E05561\u0026#34;, \u0026#34;selectionBackground\u0026#34;: \u0026#34;#FFFFFF\u0026#34;, \u0026#34;white\u0026#34;: \u0026#34;#E6E6E6\u0026#34;, \u0026#34;yellow\u0026#34;: \u0026#34;#D18F52\u0026#34; }, { \u0026#34;name\u0026#34;: \u0026#34;Catppuccin Mocha\u0026#34;, \u0026#34;cursorColor\u0026#34;: \u0026#34;#F5E0DC\u0026#34;, \u0026#34;selectionBackground\u0026#34;: \u0026#34;#585B70\u0026#34;, \u0026#34;background\u0026#34;: \u0026#34;#1E1E2E\u0026#34;, \u0026#34;foreground\u0026#34;: \u0026#34;#CDD6F4\u0026#34;, \u0026#34;black\u0026#34;: \u0026#34;#45475A\u0026#34;, \u0026#34;red\u0026#34;: \u0026#34;#F38BA8\u0026#34;, \u0026#34;green\u0026#34;: \u0026#34;#A6E3A1\u0026#34;, \u0026#34;yellow\u0026#34;: \u0026#34;#F9E2AF\u0026#34;, \u0026#34;blue\u0026#34;: \u0026#34;#89B4FA\u0026#34;, \u0026#34;purple\u0026#34;: \u0026#34;#F5C2E7\u0026#34;, \u0026#34;cyan\u0026#34;: \u0026#34;#94E2D5\u0026#34;, \u0026#34;white\u0026#34;: \u0026#34;#BAC2DE\u0026#34;, \u0026#34;brightBlack\u0026#34;: \u0026#34;#585B70\u0026#34;, \u0026#34;brightRed\u0026#34;: \u0026#34;#F38BA8\u0026#34;, \u0026#34;brightGreen\u0026#34;: \u0026#34;#A6E3A1\u0026#34;, \u0026#34;brightYellow\u0026#34;: \u0026#34;#F9E2AF\u0026#34;, \u0026#34;brightBlue\u0026#34;: \u0026#34;#89B4FA\u0026#34;, \u0026#34;brightPurple\u0026#34;: \u0026#34;#F5C2E7\u0026#34;, \u0026#34;brightCyan\u0026#34;: \u0026#34;#94E2D5\u0026#34;, \u0026#34;brightWhite\u0026#34;: \u0026#34;#A6ADC8\u0026#34; } ], \u0026#34;themes\u0026#34;: [] } Inspired by: # https://github.com/ChrisTitusTech/powershell-profile https://www.youtube.com/watch?v=Q11sSltuTE0\u0026pp ","date":"13 October 2024","permalink":"/posts/ps-profile/","section":"My Blog","summary":"","title":"PowerShell Profile"},{"content":"","date":null,"permalink":"/categories/tools/","section":"Categories","summary":"","title":"Tools"},{"content":" Download Zabbix Agent for Windows. Copy it to domain sysvol folder. Create Script and save it to sysvol ### Created using ChatGPT # Check if Zabbix agent is already installed if (Get-WmiObject -Class Win32_Product | Where-Object { $_.Name -eq \u0026#34;Zabbix Agent (64-bit)\u0026#34; }) { Write-Output \u0026#34;Zabbix Agent is already installed. Exiting...\u0026#34; Exit } $sharedFolderPath = \u0026#34;\\\\server\\share\\zabbix_agent.msi\u0026#34; $zabbixServerIP = \u0026#34;ZABBIX_SERVER_IP\u0026#34; $destinationFolder = \u0026#34;$env:TEMP\\ZabbixAgent\u0026#34; $hostname = $env:COMPUTERNAME $logFilePath = \u0026#34;C:\\ZabbixAgentInstallation_$(Get-Date -Format \u0026#39;yyyyMMdd_HHmmss\u0026#39;).log\u0026#34; # Start transcript to log actions Start-Transcript -Path $logFilePath -Force New-Item -ItemType Directory -Path $destinationFolder -Force | Out-Null Copy-Item -Path $sharedFolderPath -Destination $destinationFolder -Force $msiArguments = \u0026#34;/qn /i `\u0026#34;$destinationFolder\\zabbix_agent.msi`\u0026#34; SERVER=$zabbixServerIP HOSTNAME=$hostname\u0026#34; Start-Process -FilePath msiexec.exe -ArgumentList $msiArguments -Wait Remove-Item -Path $destinationFolder -Recurse -Force # Stop transcript Stop-Transcript Create GPO and set it as startup script in Computer policy. link GPO to required OU. ","date":"15 May 2024","permalink":"/posts/zabbixagent/","section":"My Blog","summary":"","title":"Install Zabbi Agent"},{"content":"","date":null,"permalink":"/tags/zabbix/","section":"Tags","summary":"","title":"Zabbix"},{"content":" Install Ubutnu Server 24.04 #Install MariaDB #sudo apt update \u0026amp;\u0026amp; apt full-upgrade -y sudo apt install mariadb-server sudo systemctl enable --now mariadb sudo mysql_secure_installation Install Zabbix ##run all next commands as root sudo su cd /tmp wget https://repo.zabbix.com/zabbix/6.4/ubuntu/pool/main/z/zabbix-release/zabbix-release_6.4-1+ubuntu24.04_all.deb dpkg -i zabbix-release_6.4-1+ubuntu24.04_all.deb apt update \u0026amp;\u0026amp; apt full-upgrade -y apt install zabbix-server-mysql zabbix-frontend-php zabbix-apache-conf zabbix-sql-scripts zabbix-agent Create initial database mysql -uroot -p #Enter root password create database zabbix character set utf8mb4 collate utf8mb4_bin; create user zabbix@localhost identified by \u0026#39;Zabb1x\u0026#39;; grant all privileges on zabbix.* to zabbix@localhost; set global log_bin_trust_function_creators = 1; quit; Import DB zcat /usr/share/zabbix-sql-scripts/mysql/server.sql.gz | mysql --default-character-set=utf8mb4 -uzabbix -p zabbix #Enter Zabbix user password Disable log_bin_trust_function_creators option after importing database schema. mysql -uroot -p #Enter root password set global log_bin_trust_function_creators = 0; quit; Configure the database for Zabbix server Edit file /etc/zabbix/zabbix_server.conf DBPassword=Zabb1x Start Zabbix server and agent processes systemctl restart zabbix-server zabbix-agent apache2 systemctl enable zabbix-server zabbix-agent apache2 Open Zabbix UI web page http://host/zabbix, user name Admin with password zabbix ","date":"13 May 2024","permalink":"/posts/zabbix/","section":"My Blog","summary":"","title":"Install Zabbi Server"},{"content":" Active Directory Security Download Security BaseLine, Extract \u0026amp; copy to Domain Controller:\nPolicyAnalyzer.zip Windows 11 v23H2 Security Baseline.zip Windows Server 2022 Security Baseline.zip This is latest Windows workstations \u0026amp; servers ver now, you need to download latest one.\nlinks\nGroup Policy Center Store Audit use of NTLMv1 Audit use of LDAP ","date":"8 May 2024","permalink":"/posts/adseclab2/","section":"My Blog","summary":"","title":"02-Security Baseline"},{"content":"","date":null,"permalink":"/categories/ad-security/","section":"Categories","summary":"","title":"AD Security"},{"content":"","date":null,"permalink":"/tags/adsec/","section":"Tags","summary":"","title":"Adsec"},{"content":" Active Directory Security Scripts Security BaseLine ","date":"18 April 2024","permalink":"/posts/adseclab1/","section":"My Blog","summary":"","title":"01-Introduction"},{"content":"","date":null,"permalink":"/tags/proxmox/","section":"Tags","summary":"","title":"Proxmox"},{"content":"","date":null,"permalink":"/categories/proxmox-lab/","section":"Categories","summary":"","title":"Proxmox Lab"},{"content":" Proxmox Downlaod windows ISO\u0026rsquo;s # [Windows Server2022] (https://www.microsoft.com/en-us/evalcenter/evaluate-windows-server-2022) Windows 11 Windows VirtIO Drivers Upload it to proxmox storage. Download scripts folder from https://github.com/Aabayoumy/Security-LAB #Create Windows Server 2022 STD Template # Windows 2022 guest best practices Virtualize Windows Server 2022 in Proxmox - VLANs, Sysprep, and Template! Windows Server 2022 VM conf file: root@pve1:~# cat /etc/pve/qemu-server/901.conf agent: 1 bios: ovmf boot: order=scsi0;ide0;ide2;net0 cores: 4 cpu: host efidisk0: local-lvm:vm-901-disk-0,efitype=4m,pre-enrolled-keys=1,size=4M ide0: storage:iso/virtio-win-0.1.229.iso,media=cdrom,size=522284K ide2: storage:iso/windows_server_2022_dec_2023_x64.iso,media=cdrom,size=5241400K machine: pc-q35-8.1 memory: 8192 meta: creation-qemu=8.1.5,ctime=1711960168 name: Win2k22 net0: virtio=BC:24:11:BC:DB:59,bridge=vmbr0,firewall=1 numa: 0 ostype: win11 scsi0: local-lvm:vm-901-disk-1,cache=writeback,discard=on,size=128G,ssd=1 scsihw: virtio-scsi-pci smbios1: uuid=5aa16e2e-3af5-4559-ad60-0b0689208e58 sockets: 1 tpmstate0: local-lvm:vm-901-disk-2,size=4M,version=v2.0 vmgenid: c6a03c43-1501-49ee-8539-0812576159b3 Start the VM, install windows: Select to install Windows Server 2022 Standard(Desktop Experiance) Follow the installer steps until you reach the installation type selection where you need to select \u0026ldquo;Custom (advanced)\u0026rdquo; Now click \u0026ldquo;Load driver\u0026rdquo; to install the VirtIO drivers for hard disk and the network. Hard disk: Browse to the CD drive where you mounted the VirtIO driver and select folder \u0026ldquo;amd64\\2k22\u0026rdquo; and confirm. Select the \u0026ldquo;Red Hat VirtIO SCSI pass-through controller\u0026rdquo; and click next to install it. Now you should see your drive. Network: Repeat the steps from above (click again \u0026ldquo;Load driver\u0026rdquo;, etc.) and select the folder \u0026ldquo;NetKVM\\2k19\\amd64\u0026rdquo;, confirm it and select \u0026ldquo;Redhat VirtIO Ethernet Adapter\u0026rdquo; and click next. Memory Ballooning: Again, repeat the steps but this time select the \u0026ldquo;Balloon\\2k19\\amd64\u0026rdquo; folder, then the \u0026ldquo;VirtIO Balloon Driver\u0026rdquo; and install it by clicking next. With these three drivers you should be good covered to run a fast virtualized Windows Server 2022 system. Choose the drive and continue the Windows installer steps. Install drivers from VirtIO mounted ISO \u0026ldquo;virtio-win-gt-x64.msi\u0026rdquo; then restart. Install the \u0026ldquo;Qemu Guest Agent\u0026rdquo;. The installer is located on the driver CD under guest-agent\\qemu-ga-x86_64.msi. Make full windows update and install any needed sonfware. Copy Script folder to C:\\Scripts Open PowerShell As Admin: cd c:\\Scripts .\\sysprep.cmd After VM shutdown, convert it to Template. Create Windows 11 Enterprise Template #Same as Windows servers steps\n","date":"1 April 2024","permalink":"/posts/proxmox2/","section":"My Blog","summary":"","title":"Windows Template"},{"content":" Proxmox I changed my main SSD for Proxmox that i used for Active Directory \u0026amp; security LAB, I\u0026rsquo;m docment hear my configration and prefeard settings. Also I will include my resorces.\nMy Hardware Configuration: # CPU : AMD Ryzen 5 PRO 4650G With GPU OS Drive : SATA SSD 128G VM Drive : 1 TB M.2 NVME Data Drives : 2 * 4 TB HDD \u0026ndash;\u0026gt; ZFS Mirrord \u0026ndash;\u0026gt; tank pool Intial Configuration: # Proxmox installed on 128G SSD Hostname pve1 Remove local-lvm and expand local storage Must be done before create any VM Or contianer Resorces: Proxmox install Settings for update using Proxmox Post Install Script https://tteck.github.io/Proxmox/ Storage: #1TB SSD formate and used as local-lvm\nFrom Datacenter \u0026gt; pve1 \u0026gt; Disks \u0026gt; LVM-Thin \u0026gt; Add. Used for VM \u0026amp; Continers Storage ZFS dataset storage mounted as directory storage for backup, ISO\u0026rsquo;s \u0026amp; LXC templates. Base Containers: #I alrady have backups from this continers so i just restored theme 😊\nFiles Share container (fs01): # Using TurnKey template \u0026ndash;\u0026gt; https://www.youtube.com/watch?v=I7nfSCNKeck ZFS dataset named data Mounted to Continer Share data with SMB \u0026amp; NFS Apt-Cacher-NG: # Becase i\u0026rsquo;m installing a lot of Debian based VM\u0026rsquo;s and continers so this continer will download APT packegaes once then proxe it to all my VM\u0026rsquo;s and continers. Installed form https://tteck.github.io/Proxmox/ select to be privilaged continer. Add line mp1: /tank/data/apt-cacher-ng,mp=/var/cache/apt-cacher-ng to continet config /etc/pve/lxc/101.conf to mount folder from data storage inside continer . Run this command on clints to use it as APT proxy echo 'Acquire::HTTP::Proxy \u0026quot;http://10.0.0.110:3142\u0026quot;;' \u0026gt; /etc/apt/apt.conf.d/01-proxy Resorces # Proxmox install : https://www.youtube.com/watch?v=xD9Xyt2mdSI Proxmox Security lab : https://www.youtube.com/playlist?list=PL3ljjyal211AbTqlxSo6CGBiVqsXw8wrp ","date":"30 March 2024","permalink":"/posts/proxmox/","section":"My Blog","summary":"","title":"Proxmox Reinstall"},{"content":"How to Run Run the script with administrative privileges to access machine settings. For the user settings it is better to execute them with a normal user account. Ideally, the user account is used for daily work.\nDownload HardeningKitty and copy it to the target system (script and lists). Then HardeningKitty can be imported and executed:\nImport-Module .\\HardeningKitty.psm1 Invoke-HardeningKitty -EmojiSupport ","date":"14 February 2024","permalink":"/posts/hardeningkitty/","section":"My Blog","summary":"HardeningKitty supports hardening of a Windows system.","title":"HardeningKitty"},{"content":"","date":null,"permalink":"/tags/links/","section":"Tags","summary":"","title":"Links"},{"content":"","date":null,"permalink":"/tags/security-hardening/","section":"Tags","summary":"","title":"Security Hardening"},{"content":"PingCastle is an Active Directory security assessment tool. It is designed to assess the Active Directory security level based on a risk and maturity framework. The tool helps you build a prioritized list of issues that need addressing in Active Directory. It does not aim at a perfect evaluation but rather as an efficiency compromise1.\n","date":"13 February 2024","permalink":"/posts/pingcastle/","section":"My Blog","summary":"PingCastle is an Active Directory security assessment tool.","title":"PingCastle"},{"content":" Windows Server 2022 Active Directory We will enable Remote desktop with Group policy\nCreate New Group Policy: #Open Group Policy Management console and create new Group Policy Object, name it \u0026ldquo;Allow Remote Desktop\u0026rdquo; .\n","date":"30 May 2023","permalink":"/posts/rdp/","section":"My Blog","summary":"","title":"Enable Remote Desktop"},{"content":"","date":null,"permalink":"/tags/rdp/","section":"Tags","summary":"","title":"RDP"},{"content":" Active Directory Prerequisite # Implement new LAPS https://learn.microsoft.com/en-us/windows-server/identity/laps/laps-overview You can use same script for legacy LAPS but Last command will not work with legacy LAPS PowerShell Script #$op = Get-LocalUser | where-Object Name -eq \u0026#34;ladmin\u0026#34; | Measure if ($op.Count -eq 0) { # if user not exist - create it $password = ConvertTo-SecureString \u0026#34;P@ssw0rd@1411P@ssw0rd\u0026#34; -AsPlainText -Force New-LocalUser -Name \u0026#34;ladmin\u0026#34; -Password $password -FullName \u0026#34;adminuser\u0026#34; -Description \u0026#34;Local Admin For LAPS\u0026#34; Add-LocalGroupMember -Name \u0026#39;Administrators\u0026#39; -Member \u0026#39;ladmin\u0026#39; Reset-LapsPassword # LAPS wil lreset the password } Save the script in sysvol Netlogon folder , in my domain \\\\abayoumy.local\\NETLOGON\\localadmin.ps1\nCreate GPO #Create new GPO or add this settings to same LAPS GPO My LAPS GP Report\nComputer Configuration \u0026gt; Preferences \u0026gt; Control Panel Settings \u0026gt; Scheduled Tasks Right click and select Immediate Task (At least Windows 7) (Name: ladmin)\nSet to run as user :NT AUTHORITY\\System Select Run with highest privileges\nIn Action tab :\nProgram/script: C:\\WINDOWS\\system32\\WindowsPowerShell\\v1.0\\powershell.exe Arguments: -ExecutionPolicy Bypass -command \u0026quot;\u0026amp; \\\\abayoumy.local\\NETLOGON\\localadmin.ps1\u0026quot; Apply the GPO to target computers OU and on computer run \u0026lsquo;GPupdate /force\u0026rsquo; user must create immediately and LAPS set new password\n","date":"29 May 2023","permalink":"/posts/laps/","section":"My Blog","summary":"","title":"Create new local user to use with LAPS"},{"content":"","date":null,"permalink":"/tags/laps/","section":"Tags","summary":"","title":"LAPS"},{"content":" Certificate Authority Active Directory We need Certificate Authority to secure LDAP , Remote Desktop \u0026amp; Remote PowerShell Connections.\nIt\u0026rsquo;s not recommended to install on Domain Controller in production.\nFirst Install Certificate Authority:\nUpdate Domain Controller Template MS1: # Open the Certification Authority management console with domain Admin user Right-click Certificate Templates \u0026gt; Manage In the Certificate Template Console, right-click the Kerberos Authentication template in the details pane and select Duplicate Template On the Compatibility tab: Clear the Show resulting changes check box Select Windows Server 2016 from the Certification Authority list Select Windows 10 / Windows Server 2016 from the Certificate Recipient list On the General tab Type Domain Controller Authentication (Kerberos) in Template display name Adjust the validity and renewal period to meet your enterprise\u0026rsquo;s needs On the Subject Name tab: Select the Build from this Active Directory information button if it isn\u0026rsquo;t already selected Select None from the Subject name format list Select DNS name from the Include this information in alternate subject list Clear all other items On the Cryptography tab: Select Key Storage Provider from the Provider Category list Select RSA from the Algorithm name list Type 2048 in the Minimum key size text box Select SHA256 from the Request hash list Select the Superseded Templates tab. Select Add From the Add Superseded Template dialog, select the Domain Controller certificate template and select OK \u0026gt; Add From the Add Superseded Template dialog, select the Domain Controller Authentication certificate template and select OK From the Add Superseded Template dialog, select the Kerberos Authentication certificate template and select OK -Add any other enterprise certificate templates that were previously configured for domain controllers to the Superseded Templates tab Select OK and close the Certificate Templates console Right-click Certificate Templates \u0026gt; New \u0026gt; Certificate Template to Issue Select Domain Controller Authentication (Kerberos) \u0026amp; Ok Configure Group Policy to autoenroll certificates MS2: # Open the Group Policy Management console. In the navigation pane, expand Forest: YourForestName, expand Domains, expand YourDomainName, expand Group Policy Objects, right-click Default Domain Controllers Policy GPO, and then click Edit. In the navigation pane, expand the following path: Computer Configuration \u0026gt; Policies \u0026gt; Windows Settings \u0026gt; Security Settings \u0026gt; Public Key Policies. Double-click Certificate Services Client - Auto-Enrollment. In the Properties dialog box, change Configuration Model to Enabled. Select both Renew expired certificates, update pending certificates, and remove revoked certificates and Update certificates that use certificate templates. Click OK to save your changes. Computers apply the GPO and download the certificate the next time Group Policy is refreshed. On Domain Controllers run command \u0026lsquo;gpupdate /force\u0026rsquo; on administrative PowerShell or CMD. In Certification Authority management console Check Issued Certificates. ","date":"7 May 2023","permalink":"/posts/certificateauthority/","section":"My Blog","summary":"","title":"4- Install Certificate Authority"},{"content":"","date":null,"permalink":"/tags/certificate-authority/","section":"Tags","summary":"","title":"Certificate Authority"},{"content":" Hyper-V Windows Server 2022 Active Directory PreRequest # Hyper-v installation # Create Windows Server 2022 Master Disk with SysPrep # Install Active directory 1st Domain Controller #Create VM #Open PowerShell as administrator and run this commands:\n$vm = \u0026#34;DC01\u0026#34; # name of VM, this just applies in Windows, it isn\u0026#39;t applied to the OS guest itself. $vhdx = \u0026#34;D:\\images\\windows2022-master.vhdx\u0026#34; $vmswitch = \u0026#34;NAT\u0026#34; # name of your local vswitch $port = \u0026#34;port1\u0026#34; # port on the VM $vlan = 1 # VLAN that VM traffic will be send in $cpu = 2 # Number of CPUs $ram = 4GB # RAM of VM. Note this is not a string, not in quotation marks # Create a new VM New-VM $vm -Generation 2 # Set the CPU and start-up RAM Set-VM $vm -ProcessorCount $cpu -MemoryStartupBytes $ram # Get default VHD path (requires administrative privileges) $vmms = Get-WmiObject -namespace root\\virtualization\\v2 Msvm_VirtualSystemManagementService $vmmsSettings = Get-WmiObject -namespace root\\virtualization\\v2 Msvm_VirtualSystemManagementServiceSettingData $vhdxPath = Join-Path $vmmsSettings.DefaultVirtualHardDiskPath \u0026#34;$vm-disk1.vhdx\u0026#34; Copy-Item -Path $vhdx -Destination $vhdxPath # Add the new disk to the VM Add-VMHardDiskDrive -VMName $vm -Path $vhdxPath # Remove the default VM NIC named \u0026#39;Network Adapter\u0026#39; Remove-VMNetworkAdapter -VMName $vm # Add a new NIC to the VM and set its name Add-VMNetworkAdapter -VMName $vm -Name $port # Configure the NIC as access and assign VLAN #Set-VMNetworkAdapterVlan -VMName $vm -VMNetworkAdapterName $port # Connect the NIC to the vswitch Connect-VMNetworkAdapter -VMName $vm -Name $port -SwitchName $vmswitch Set-VM -Name $vm -CheckpointType Disabled Disable-VMIntegrationService -VMName $vm \u0026#34;Time Synchronization\u0026#34; Enable-VMIntegrationService -VMName $vm \u0026#34;Guest Service Interface\u0026#34; Start-VM -VMName $vm VMConnect.exe localhost $vm In first boot you need to set Administrator password and wait till windows fully loaded .\nSet VM static IP, Hostname \u0026amp; Restart #$plainPassword = \u0026#34;P@ssw0rd\u0026#34; $password = $plainPassword | ConvertTo-SecureString -asPlainText -Force $credential = New-Object System.Management.Automation.PSCredential(\u0026#34;administrator\u0026#34;, $password) $vm = \u0026#34;DC01\u0026#34; $session = New-PSSession -Vmname $vm -Credential $credential -Verbose $code = { netsh int ip set address \u0026#34;ethernet\u0026#34; static 172.30.0.10 255.255.255.0 172.30.0.1 1 netsh interface ipv4 add dnsserver name=Ethernet address=172.30.0.12 index=1 validate=no netsh interface ipv4 add dnsserver name=Ethernet address=172.30.0.10 index=2 validate=no netsh interface ipv4 add dnsserver name=Ethernet address=8.8.8.8 index=3 validate=no Rename-Computer DC01 -Force -Restart Exit } Invoke-Command -Session $session -ScriptBlock $code Wait till windows restart.\nInstall Active Directory Domain #$plainPassword = \u0026#34;P@ssw0rd\u0026#34; $password = $plainPassword | ConvertTo-SecureString -asPlainText -Force $credential = New-Object System.Management.Automation.PSCredential(\u0026#34;administrator\u0026#34;, $password) $vm = \u0026#34;DC01\u0026#34; $session = New-PSSession -Vmname $vm -Credential $credential -Verbose $code = { $plainPassword = \u0026#34;P@ssw0rd\u0026#34; # Administrator Password $password = $plainPassword | ConvertTo-SecureString -asPlainText -Force $credential = New-Object System.Management.Automation.PSCredential(\u0026#34;administrator\u0026#34;, $password) $SafeModeAdministratorPassword = \u0026#34;P@ssw0rd\u0026#34; | ConvertTo-SecureString -asPlainText -Force # DSRM Password $domainName = \u0026#34;contoso\u0026#34; $domain = \u0026#34;$domainName.local\u0026#34; Write-Host \u0026#34;Installing management tools\u0026#34; Import-Module ServerManager Add-WindowsFeature RSAT-AD-PowerShell,RSAT-AD-AdminCenter Write-Host \u0026#34;Deploying Active Directory Domain...\u0026#34; Install-WindowsFeature AD-domain-services, DNS -IncludeAllSubFeature -IncludeManagementTools -Restart Import-Module ADDSDeployment Install-ADDSForest ` -SafeModeAdministratorPassword $SafeModeAdministratorPassword ` -CreateDnsDelegation:$false ` -DatabasePath \u0026#34;C:\\Windows\\NTDS\u0026#34; ` -DomainMode \u0026#34;7\u0026#34; ` -DomainName $domain ` -DomainNetbiosName $domainName ` -ForestMode \u0026#34;7\u0026#34; ` -InstallDns:$true ` -LogPath \u0026#34;C:\\Windows\\NTDS\u0026#34; ` -NoRebootOnCompletion:$true ` -SysvolPath \u0026#34;C:\\Windows\\SYSVOL\u0026#34; ` -Force:$true Restart-Computer -Force -Verbose } Invoke-Command -Session $session -ScriptBlock $code After VM restart, you can logon to new created Domain :)\nInstall Additional Domain Controller #Create new VM #Open PowerShell as administrator and run this commands:\n$vm = \u0026#34;DC02\u0026#34; # name of VM, this just applies in Windows, it isn\u0026#39;t applied to the OS guest itself. $vhdx = \u0026#34;D:\\images\\windows2022-master.vhdx\u0026#34; $vmswitch = \u0026#34;NAT\u0026#34; # name of your local vswitch $port = \u0026#34;port1\u0026#34; # port on the VM $vlan = 1 # VLAN that VM traffic will be send in $cpu = 2 # Number of CPUs $ram = 4GB # RAM of VM. Note this is not a string, not in quotation marks # Create a new VM New-VM $vm -Generation 2 # Set the CPU and start-up RAM Set-VM $vm -ProcessorCount $cpu -MemoryStartupBytes $ram # Get default VHD path (requires administrative privileges) $vmms = Get-WmiObject -namespace root\\virtualization\\v2 Msvm_VirtualSystemManagementService $vmmsSettings = Get-WmiObject -namespace root\\virtualization\\v2 Msvm_VirtualSystemManagementServiceSettingData $vhdxPath = Join-Path $vmmsSettings.DefaultVirtualHardDiskPath \u0026#34;$vm-disk1.vhdx\u0026#34; Copy-Item -Path $vhdx -Destination $vhdxPath # Add the new disk to the VM Add-VMHardDiskDrive -VMName $vm -Path $vhdxPath # Remove the default VM NIC named \u0026#39;Network Adapter\u0026#39; Remove-VMNetworkAdapter -VMName $vm # Add a new NIC to the VM and set its name Add-VMNetworkAdapter -VMName $vm -Name $port # Configure the NIC as access and assign VLAN #Set-VMNetworkAdapterVlan -VMName $vm -VMNetworkAdapterName $port # Connect the NIC to the vswitch Connect-VMNetworkAdapter -VMName $vm -Name $port -SwitchName $vmswitch Set-VM -Name $vm -CheckpointType Disabled Disable-VMIntegrationService -VMName $vm \u0026#34;Time Synchronization\u0026#34; Enable-VMIntegrationService -VMName $vm \u0026#34;Guest Service Interface\u0026#34; Start-VM -VMName $vm VMConnect.exe localhost $vm In first boot you need to set Administrator password and wait till windows fully loaded .\nSet VM static IP, Hostname \u0026amp; Restart #$plainPassword = \u0026#34;P@ssw0rd\u0026#34; $password = $plainPassword | ConvertTo-SecureString -asPlainText -Force $credential = New-Object System.Management.Automation.PSCredential(\u0026#34;administrator\u0026#34;, $password) $vm = \u0026#34;DC02\u0026#34; $session = New-PSSession -Vmname $vm -Credential $credential -Verbose $code = { netsh int ip set address \u0026#34;ethernet\u0026#34; static 172.30.0.12 255.255.255.0 172.30.0.1 1 netsh interface ipv4 add dnsserver name=Ethernet address=172.30.0.10 index=1 validate=no netsh interface ipv4 add dnsserver name=Ethernet address=8.8.8.8 index=3 validate=no Rename-Computer DC02 -Force -Restart Exit } Invoke-Command -Session $session -ScriptBlock $code Wait till windows restart.\nInstall Additional Domain Controller #$plainPassword = \u0026#34;P@ssw0rd\u0026#34; $password = $plainPassword | ConvertTo-SecureString -asPlainText -Force $credential = New-Object System.Management.Automation.PSCredential(\u0026#34;administrator\u0026#34;, $password) $vm = \u0026#34;DC02\u0026#34; $session = New-PSSession -Vmname $vm -Credential $credential -Verbose $code = { $plainPassword = \u0026#34;P@ssw0rd\u0026#34; # Administrator Password $password = $plainPassword | ConvertTo-SecureString -asPlainText -Force $credential = New-Object System.Management.Automation.PSCredential(\u0026#34;administrator\u0026#34;, $password) $SafeModeAdministratorPassword = \u0026#34;P@ssw0rd\u0026#34; | ConvertTo-SecureString -asPlainText -Force # DSRM Password $domainName = \u0026#34;contoso\u0026#34; $domain = \u0026#34;$domainName.local\u0026#34; Write-Host \u0026#34;Installing management tools\u0026#34; Import-Module ServerManager Add-WindowsFeature RSAT-AD-PowerShell,RSAT-AD-AdminCenter Write-Host \u0026#34;Deploying Additional Domain Controller...\u0026#34; Install-WindowsFeature AD-domain-services, DNS -IncludeAllSubFeature -IncludeManagementTools -Restart Import-Module ADDSDeployment Install-ADDSDomainController ` -SafeModeAdministratorPassword $SafeModeAdministratorPassword ` -CreateDnsDelegation:$false ` -DatabasePath \u0026#34;C:\\Windows\\NTDS\u0026#34; ` -DomainName $domain ` -InstallDns:$true ` -Credential (Get-Credential) ` -LogPath \u0026#34;C:\\Windows\\NTDS\u0026#34; ` -NoRebootOnCompletion:$true ` -SysvolPath \u0026#34;C:\\Windows\\SYSVOL\u0026#34; ` -Force:$true Restart-Computer -Force -Verbose } Invoke-Command -Session $session -ScriptBlock $code Will ask you for domain Admin user \u0026amp; Password .\nNext # Time Sync Configuration in Active Directory #","date":"30 April 2023","permalink":"/posts/newvm/","section":"My Blog","summary":"","title":"3- Create VM from Master Image"},{"content":"","date":null,"permalink":"/tags/hyper-v/","section":"Tags","summary":"","title":"Hyper-V"},{"content":" Hyper-V Windows Server 2022 PreRequest : Hyper-v installation #Create Windows server 2022 VM . #To Create First VM, Open PowerShell as administrator and run this commands:\n# This script is in two parts. First we declare the variables to be applied. $vm = \u0026#34;Master2022\u0026#34; # name of VM, this just applies in Windows, it isn\u0026#39;t applied to the OS guest itself. $image = \u0026#34;D:\\images\\SERVER_2022_EVAL_x64FRE_en-us.iso\u0026#34; $vmswitch = \u0026#34;NAT\u0026#34; # name of your local vswitch $port = \u0026#34;port1\u0026#34; # port on the VM $vlan = 1 # VLAN that VM traffic will be send in $cpu = 2 # Number of CPUs $ram = 4GB # RAM of VM. Note this is not a string, not in quotation marks $path_to_disk = \u0026#34;d:\\Hyper-V\\Virtual Hard Disks\\\u0026#34; # Where you want the VM\u0026#39;s virtual disk to reside $disk_size = 20GB # VM storage, again, not a string # Create a new VM New-VM $vm -Generation 2 # Set the CPU and start-up RAM Set-VM $vm -ProcessorCount $cpu -MemoryStartupBytes $ram # Create the new VHDX disk - the path and size. New-VHD -Path $path_to_disk$vm-disk1.vhdx -SizeBytes $disk_size # Add the new disk to the VM Add-VMHardDiskDrive -VMName $vm -Path $path_to_disk$vm-disk1.vhdx # Assign the OS ISO file to the VM Add-VMDvdDrive -VMName $vm -Path $image # Set DVD Drive as first bootrm Set-VMFirmware -VMName $vm -FirstBootDevice ( Get-VMDvdDrive -VMName $vm) # Remove the default VM NIC named \u0026#39;Network Adapter\u0026#39; Remove-VMNetworkAdapter -VMName $vm # Add a new NIC to the VM and set its name Add-VMNetworkAdapter -VMName $vm -Name $port # Configure the NIC as access and assign VLAN #Set-VMNetworkAdapterVlan -VMName $vm -VMNetworkAdapterName $port # Connect the NIC to the vswitch Connect-VMNetworkAdapter -VMName $vm -Name $port -SwitchName $vmswitch Set-VM -Name $vm -CheckpointType Disabled Disable-VMIntegrationService -VMName $vm \u0026#34;Time Synchronization\u0026#34; Enable-VMIntegrationService -VMName $vm \u0026#34;Guest Service Interface\u0026#34; Compleat windows installation with full desktop experience - not core installation. #Start VM and compleat the installation \u0026amp; Make sue that windows is fully updated. Open explorer and go to path C:\\Windows\\System32\\Sysprep . Run sysprep and select Generalize \u0026amp; Shutdown . Wait till VM shutdown then take a copy or Zip the VM hard disk .\n","date":"16 January 2023","permalink":"/posts/master2022/","section":"My Blog","summary":"","title":"2- Create Windows Server 2022 Master Disk with SysPrep"},{"content":"","date":null,"permalink":"/tags/sysprep/","section":"Tags","summary":"","title":"SysPrep"},{"content":" Serves installation Hyper-V Enable Hyper-V : # Windows 10/11 Pro Computer with good amount of memory at least 16G, i have 32G and more is preferred 😃 Enable Hyper-v on Windows: Open PowerShell As Admin and run command and restart. Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Hyper-V -All Download Windows Server 2022 ISO Download Windows 10 ISO or Windows 11 ISO I prefer to change Hyper-V default folder to D:\\HYPER-V\nD:\\HYPER-V ├───Virtual Hard Disks └───Virtual Machines Copy all ISO\u0026rsquo;s on one folder also\nD:\\IMAGES SERVER_2022_EVAL_x64FRE_en-us.iso Win10_ent.iso Win11_22H2_English_x64v1.iso In Hyper-V Settings change path for Virtual Hard Disks \u0026amp; Virtual Machines. Create Hyper-V Nat Network \u0026amp; NAT Switch #This configuration will but all VM\u0026rsquo;s on isolated subnet and allow them to access internet Set up a NAT network | Microsoft Docs\nCreate new VMSwitch and name it NAT\nNew-VMSwitch -SwitchName \u0026#34;NAT\u0026#34; -SwitchType Internal List all network interface and note the interface ifIndex value of new create VMSwitch interface\nGet-NetAdapter My Ethernet adaptor ifIndex = 46 and will use subnet 172.30.0.0/24 for NAT network.\nNew-NetIPAddress -IPAddress 172.30.0.1 -PrefixLength 24 -InterfaceIndex 46 New-NetNat -Name NAT17230 -InternalIPInterfaceAddressPrefix 172.30.0.0/24 Use small DHCP server to auto configure IP on VM\u0026rsquo;s on NAT network : www.dhcpserver.de\n","date":"13 January 2023","permalink":"/posts/prerequest/","section":"My Blog","summary":"","title":"1- Enable Hyper-V \u0026 Prerequest"},{"content":"","date":null,"permalink":"/tags/ntp/","section":"Tags","summary":"","title":"NTP"},{"content":" Active Directory Windows Time Service This is enhanced ver of old Microsoft Article\nWhy time sync in active directory is important? # If client computer time out of sync from DC more than 5 min , Kerberos will not work, and DC will refuse to issue TGT :) Also DC\u0026rsquo;s resolve replication conflict by comparing time. Business applications record operations time stamp ,and not synced time create issues, specially on Banks \u0026amp; governmental environment. You have 3 Options to set windows Time service setting\nRegistry : Not recommended to directly edit Registry. Commands : you will execute w32tm command on each computer. Group Policy : Prefeared to automate the setting. Configure Windows Time Service by w32tm Command: # On PDC execute command : w32tm /config /manualpeerlist: time.windows.com:0x9 /syncfromflags:manual /reliable:yes /update On all other DC\u0026rsquo;s , Member servers \u0026amp; Domain computers w32tm /config /syncfromflags:domhier /update When move PDC FSMO : you have to run this commands on old and new PDC.\nConfigure Windows Time Service by Group Policy #We will create 2 GPO\u0026rsquo;s each one with WMI filter, Open Group Policy Management console :\nCreate WMI filter name it PDC with value: Select * from Win32_ComputerSystem where DomainRole = 5 this will be true only if computer is DC and have PDC FSMO.\nCreate WMI filter name it NOT PDC with value: Select * from Win32_ComputerSystem where DomainRole \u0026lt;\u0026gt; 5 this will be true on all other computers other that DC with PDC FSMO.\nCreate New GPO Name it TimeSync for PDC and edit, goto this path: Computer Configuration\\Administrative Templates\\System\\Windows Time Service\\Time Providers double click Configure Windows NTP Client keep NtpServer as defult and change Type = NTP , Then Enable Windows NTP Client.\nCreate New GPO Name it TimeSync for All and edit, goto this path: Computer Configuration\\Administrative Templates\\System\\Windows Time Service\\Time Providers double click Configure Windows NTP Client keep NtpServer as default and change Type = NT5DS, Then Enable Windows NTP Client.\nLink GPO TimeSync for All to domain top level and force it .\nLink GPO TimeSync for PDC to Domain Controllers OU.\nWhen move PDC FSMO : Setting will correct after automate or manually group policy.\nTest configuration: #PDC # On PDC force Group Policy update Gpupdate /force Force time sync w32tm /resync /rediscover Check status \u0026amp; last sync w32tm /query /status source must be time.windows.com Check effective configuration w32tm /query /configuration Other DC # On any DC ,force Group Policy update Gpupdate /force Force time sync w32tm /resync /rediscover Check status \u0026amp; last sync w32tm /query /status source must be the PDC. Check effective configuration w32tm /query /configuration Any Member server or workstation # On any other computer,force Group Policy update Gpupdate /force Force time sync w32tm /resync /rediscover Check status \u0026amp; last sync w32tm /query /status source must be any DC. Check effective configuration w32tm /query /configuration ","date":"13 January 2023","permalink":"/posts/ntp/","section":"My Blog","summary":"","title":"Time Sync Configuration in Active Directory"},{"content":"","date":null,"permalink":"/tags/windows-time-service/","section":"Tags","summary":"","title":"Windows Time Service"},{"content":"👋 Hello, when i leave from Microsoft this what i received form my friends and colleges there 💕\nAll the best for you Dears 😍❤️ .\n","date":"22 December 2022","permalink":"/posts/whatsapp/","section":"My Blog","summary":"","title":"Friends Massages "},{"content":"","date":null,"permalink":"/tags/me/","section":"Tags","summary":"","title":"Me"},{"content":"👋 Hello There, My Name is Ahmed Mohamed Bayoumy AKA Bayoumy 😍\nSecurity Consultant (OnPrem \u0026amp; Azure), Experienced System/Network Administrator with 20+ Years Technical experience. Skills include servers, network, analytical thinking and creative problem solving. focused on Windows servers \u0026amp; Active Directory.\nWork Experiences: # Senior Security Consultant @ Global Brands (5/2024-Now) # OnPrem Active Directory Security Assessment \u0026amp; Hardening. Implement Microsoft Defender for Identity. Implement Microsoft Defender for Office 365. Security Consultant @ Global Brands (5/2023-4/2024) # OnPrem Active Directory Security Assessment \u0026amp; Hardening. Implement Microsoft Defender for Identity. Implement Microsoft Defender for Office 365. Senior infrastructure Manager @ Palm Hills Development (1/2023-4/2023) # Leading Technical projects in alignment of business goals . Supervise infrastructure team,and help Technical support Team as second line support. Ensure that the technology infrastructure runs smoothly and efficiently, especially for core business applications - CRM \u0026amp; ERP. Maintain, upgrade and manage the company systems, hardware, and networks. Manage Office 365 \u0026amp; Azure Tenants, On Prem AD \u0026amp; VMWare vSphare with Lenovo Blades \u0026amp; SAN. Active Directory Support Engineer @ Microsoft (7/2021-12/2022) # Support all Active Directory technologys for MEA customers. Mentor for 3 Team members. Associated Manager @ IFFCO Saudi Arabia (11/2010-1/2011) # IT Associated Manager : Manage team across KSA. Manage IT Assets, licenses and Purchases. System \u0026amp; Network Administrator. Secure Servers \u0026amp; Workstations with Symantec EndPoint. Support Sales rep HandHeld HW \u0026amp; SW. Team Leader @ IBM in Ministry of interior, Passport Issue Project (11/2008-11/2010) # Manage Microsoft products: Windows server, AD \u0026amp; clusters. Secure Servers \u0026amp; Workstations with Symantec EndPoint. Manage IBM TSM backup. Microsoft instructor (Part time 2008-2010) # Teach MCSE 2003 \u0026amp; Exchange 2007 courses. System Administrator @ IFFCO Egypt (2/2006-11/2008) # Users Support (PC - Laptop). From 6-2007: support servers \u0026amp; network. Manage IT Assets, licenses and Purchases. Help Disk @ SIMA (6/2003-2/2006) # Users Support (PC,Laptop \u0026amp; Printers). Software Developer VB.Net (Windows Application – Web Application). SQL Database Administrator. Help Disk @ Elkateb Computers (2/2022-11/2003) # HelpDesk Users \u0026amp; Computers Support (PC,Laptop \u0026amp; Printers). Skills: # Team Management \u0026amp; Lead. Manage IT Badged \u0026amp; Procurements. Support Windows Servers. Active Directory Expert. PowerShell Scripting. Manage Network - Cisco \u0026amp; FortiGate. BackupExec. Symantec Enterprise antivirus. Manage Linux Servers, with good knowledge in Docker \u0026amp; containers. Certificates: Microsoft Certification Transcript # SC-200 Microsoft Certified: Security Operations Analyst Associate .\nSC-300 Microsoft Certified: Microsoft Identity and Access Administrator .\nVB.Net 2003 (Windows \u0026amp; Web)\nMCSA 2003\nMSITPro 2012.\nExchange 2007.\nMy Resume\n","date":"11 November 2022","permalink":"/posts/aboutme/","section":"My Blog","summary":"","title":"About Me"}]